{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoice #{{ order.order_id }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-black: #000000;
            --primary-white: #ffffff;
            --gray-50: #f8f9fa;
            --gray-100: #f1f3f5;
            --gray-200: #e9ecef;
            --gray-300: #dee2e6;
            --gray-400: #ced4da;
            --gray-500: #adb5bd;
            --gray-600: #868e96;
            --gray-700: #495057;
            --gray-800: #343a40;
            --gray-900: #212529;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--primary-white);
            color: var(--gray-900);
            margin: 0;
            padding: 1rem;
            line-height: 1.4;
            font-size: 12pt; /* Reduced for compactness */
        }

        .invoice-container {
            max-width: 800px;
            margin: 0 auto;
            background-color: var(--primary-white);
            border: 1px solid var(--gray-300);
            padding: 1.5rem;
        }

        .invoice-header {
            text-align: center;
            padding: 1rem 0;
            background-color: var(--gray-900);
            color: var(--primary-white);
            margin-bottom: 1.5rem;
        }

        .invoice-header .brand {
            font-size: 2.5rem;
            font-weight: 900;
            text-transform: uppercase;
            margin: 0;
            letter-spacing: 0.1em;
        }

        .invoice-header h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0.5rem 0;
        }

        .invoice-header p {
            font-size: 0.9rem;
            margin: 0;
            font-weight: 400;
        }

        .company-details, .customer-details {
            margin-bottom: 1rem;
            padding: 0.75rem;
            border: 1px solid var(--gray-300);
        }

        .company-details h4, .customer-details h4 {
            font-size: 1rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 0.5rem;
        }

        .company-details p, .customer-details p {
            margin: 0.3rem 0;
            font-size: 0.85rem;
            color: var(--gray-700);
        }

        .details-table {
            width: 100%;
            margin-bottom: 1rem;
            border-collapse: collapse;
            border: 1px solid var(--gray-300);
        }

        .details-table td {
            padding: 0.5rem;
            font-size: 0.85rem;
            border: 1px solid var(--gray-300);
        }

        .details-table td:first-child {
            font-weight: 600;
            color: var(--gray-900);
            width: 40%;
            background-color: var(--gray-100);
        }

        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1rem;
            border: 1px solid var(--gray-300);
        }

        .items-table th, .items-table td {
            padding: 0.5rem;
            font-size: 0.85rem;
            border: 1px solid var(--gray-300);
            text-align: left;
        }

        .items-table th {
            background-color: var(--gray-800);
            color: var(--primary-white);
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.8rem;
        }

        .items-table .total-row {
            font-weight: 700;
            background-color: var(--gray-200);
        }

        .items-table .total-row td {
            padding: 0.75rem;
        }

        .footer-note {
            text-align: center;
            color: var(--gray-600);
            font-size: 0.8rem;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--gray-300);
        }

        @media print {
            body {
                padding: 0;
                margin: 0;
                background-color: var(--primary-white);
            }
            .invoice-container {
                border: none;
                padding: 0.5rem;
            }
            .invoice-header {
                background-color: var(--gray-900);
            }
        }
    </style>
</head>
<body>
    <div class="invoice-container">
        <div class="invoice-header">
            <h1 class="brand">Velora</h1>
            <h2>Invoice #{{ order.order_id }}</h2>
            <p>Issued on: {{ order_time_ist|date:"F j, Y" }}</p>
        </div>

        <div class="row">
            <div class="col-6 company-details">
                <h4>From</h4>
                <p>Velora</p>
                <p>123 Business Street, Commerce City</p>
                <p>India, 123456</p>
                <p>Email: support@velora.com</p>
            </div>
            <div class="col-6 customer-details">
                <h4>Billed To</h4>
                <p>{{ request.user.get_full_name|default:"Customer" }}</p>
                <p>{{ address.address_line1 }}</p>
                {% if address.address_line2 %}
                    <p>{{ address.address_line2 }}</p>
                {% endif %}
                <p>{{ address.city }}, {{ address.state }} {{ address.postal_code }}</p>
                <p>{{ address.country }}</p>
                <p>Phone: {{ address.phone|default:"Not provided" }}</p>
            </div>
        </div>

        <h3>Order Details</h3>
        <table class="details-table">
            <tr>
                <td><strong>Order Date</strong></td>
                <td>{{ order_time_ist|date:"F j, Y, H:i" }} IST</td>
            </tr>
            <tr>
                <td><strong>Payment Method</strong></td>
                <td>{{ payment_method }}</td>
            </tr>
            <tr>
                <td><strong>Payment Status</strong></td>
                <td>{% if is_paid %}Paid{% else %}Not Paid{% endif %}</td>
            </tr>
            <tr>
                <td><strong>Order Status</strong></td>
                <td>{{ order.get_status_display }}</td>
            </tr>
        </table>

        <h3>Items</h3>
        <table class="items-table">
            <thead>
                <tr>
                    <th>Description</th>
                    <th>Unit Price</th>
                    <th>Quantity</th>
                    <th>Total</th>
                </tr>
            </thead>
            <tbody>
                {% for item in order.items.all %}
                    <tr>
                        <td>
                            {{ item.product.name|default:"Deleted Product" }}
                            {% if item.variant %}
                                - {{ item.variant.color_variant.color_name }} ({{ item.size }})
                            {% elif item.size %}
                                - {{ item.size }}
                            {% endif %}
                        </td>
                        <td>₹{{ item.price|floatformat:2 }}</td>
                        <td>{{ item.quantity }}</td>
                        <td>₹{{ item.total|floatformat:2 }}</td>
                    </tr>
                {% endfor %}
                <tr class="total-row">
                    <td colspan="3" style="text-align: right;"><strong>Total Amount</strong></td>
                    <td>₹{{ order.total|floatformat:2 }}</td>
                </tr>
            </tbody>
        </table>

        <div class="footer-note">
            Thank you for your purchase! For any queries, contact us at <a href="mailto:support@velora.com" style="color: var(--gray-900); text-decoration: none;">support@velora.com</a>.
        </div>
    </div>
</body>
</html>